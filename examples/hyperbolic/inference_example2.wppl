var start = { 
  loc : [3,0],
  terminateAfterAction : false,
   
  timeLeft : 13
};

var world = makeDonutWorld2({ big : true, maxTimeAtRestaurant : 2});
var donutUtility = makeDonutUtility(world, {
    'Donut N' : [1, -1],
    'Donut S' : [1, -1],
    'Veg'   : [-1, 2],
    'Noodle': [0, 0]
});

var actual_agent = makeHyperbolicDiscounter(
    { utility : donutUtility,
      alpha : 500, 
      discount : 1, 
      sophisticatedOrNaive  : 'sophisticated' 
    }, world);
var observed = simulateHyperbolic(start, world, actual_agent);

var posterior = timeit( function () {
MH(function () {
  var discount = randomInteger(3); 
  var type = uniformDraw(['sophisticated', 'naive']);
  var alpha = uniformDraw([1, 10, 100, 500]);
  var dU = randomInteger(4) - 1;
  var vU = randomInteger(4) - .5;

  var donutUtility = makeDonutUtility(world, {
      'Donut N' : [dU, -1],
      'Donut S' : [dU, -1],
      'Veg'   : [-1,  vU],
      'Noodle': [0,  0]
  });

  var agent = makeHyperbolicDiscounter(
      { utility : donutUtility,
        alpha : alpha, 
        discount : discount, 
        sophisticatedOrNaive  : type,
      }, world);
  var agentAction = agent.act;

  map(function (stateAction) {
    var state = stateAction[0];
    var action = stateAction[1];

    factor(agentAction(state, 0).score([], action)) ; 
  }, observed);

  return { type:type, discount:discount, alpha:alpha, dU:dU, vU:vU };
})

});
if (typeof(document) !== 'undefined') { viz.print(posterior.value); }
else {printERP(posterior.value)}
